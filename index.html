<!DOCTYPE html>
<html>
<head>
  <title>Bangalore Colleges Map</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    body {
      margin: 0;
      font-family: 'Quicksand', sans-serif;
      background: #f5f5f5;
    }
    #controls {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1000;
      width: 95%;
      max-width: 600px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
    }
    #searchInput, #areaFilter {
      padding: 10px;
      font-size: 15px;
      border: 1px solid #ccc;
      border-radius: 8px;
      width: 100%;
      max-width: 280px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    }
    #map {
      position: absolute;
      top: 70px;
      bottom: 0;
      left: 0;
      right: 0;
    }
    .leaflet-popup-content-wrapper {
      font-size: 14px;
    }
  </style>
</head>
<body>

  <div id="controls">
    <input type="text" id="searchInput" placeholder="üîç Search by name or location..." />
    <select id="areaFilter">
      <option value="">üìç Filter by area</option>
    </select>
  </div>

  <div id="map"></div>

  <script>
    const map = L.map('map').setView([12.9716, 77.5946], 11);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Map data ¬© OpenStreetMap contributors'
    }).addTo(map);

    const markers = [];
    let colleges = [];

    fetch("https://raw.githubusercontent.com/taruncodeplace6666/data/main/colleges.json")
      .then(res => res.json())
      .then(data => {
        colleges = data;
        populateMarkers(colleges);
        populateAreaFilter(colleges);
      });

    function populateMarkers(data) {
      data.forEach(college => {
        if (college.Latitude && college.Longitude) {
          const marker = L.marker([college.Latitude, college.Longitude])
            .addTo(map)
            .bindPopup(`<strong>${college.Name}</strong><br>${college.Location}`);
          marker.collegeData = college;
          markers.push(marker);
        }
      });
    }

    function populateAreaFilter(data) {
      const areaSelect = document.getElementById('areaFilter');
      const areas = [...new Set(data.map(col => getArea(col.Location)))].sort();
      areas.forEach(area => {
        const opt = document.createElement('option');
        opt.value = area;
        opt.textContent = area;
        areaSelect.appendChild(opt);
      });
    }

    function getArea(location) {
      if (!location) return '';
      const parts = location.split(',');
      return parts[parts.length - 1].trim().toUpperCase();  
    }

    document.getElementById('searchInput').addEventListener('input', function () {
      const query = this.value.toLowerCase();
      markers.forEach(marker => {
        const name = marker.collegeData.Name.toLowerCase();
        const location = marker.collegeData.Location.toLowerCase();
        if (name.includes(query) || location.includes(query)) {
          marker.setOpacity(1);
          marker.addTo(map);
        } else {
          marker.remove();
        }
      });
    });

    document.getElementById('areaFilter').addEventListener('change', function () {
      const area = this.value.toLowerCase();
      markers.forEach(marker => {
        const loc = getArea(marker.collegeData.Location).toLowerCase();
        if (!area || loc === area) {
          marker.setOpacity(1);
          marker.addTo(map);
        } else {
          marker.remove();
        }
      });
    });
  </script>
</body>
</html>

